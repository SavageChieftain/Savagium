/* Generated by Opal 0.10.5 */
(function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_divide(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  var self = Opal.top, $scope = Opal, nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $gvars = Opal.gvars, $hash2 = Opal.hash2;

  Opal.add_stubs(['$freeze', '$map', '$to_proc', '$join', '$new', '$clearPrefixes', '$!', '$empty?', '$prefixs', '$prefixes', '$class', '$puts', '$gameType', '$setPrefixes', '$attr_accessor', '$attr_reader', '$gameName', '$getHelpMessage', '$rand', '$check_suc', '$roll', '$marshalSignOfInequality', '$unlimitedRollDiceType', '$getD66Value', '$rollDiceAddingUp', '$parren_killer', '$debug', '$isGetOriginalMessage', '$getOriginalMessage', '$=~', '$prefixesPattern', '$removeDiceCommandMessage', '$rollDiceCommandCatched', '$nil?', '$!=', '$sub', '$rollDiceCommand', '$to_s', '$get_table_by_nD6', '$get_table_by_nDx', '$getTableValue', '$[]', '$-', '$/', '$getD66', '$bcdice', '$get_table_by_number', '$+', '$*', '$getDiceListFromDiceText', '$collect', '$to_i', '$split', '$each', '$>=', '$kind_of?', '$lambda', '$call', '$select', '$===', '$public_methods', '$send', '$upcase', '$==', '$getTableInfoFromExtraTableText', '$get_table_by_nDx_extratable', '$get_table_by_d66', '$%', '$get_table_by_d66_swap', '$raise', '$gsub!', '$rollTableMessageDiceText', '$size', '$inspect']);
  return (function($base, $super) {
    function $DiceBot(){};
    var self = $DiceBot = $klass($base, $super, 'DiceBot', $DiceBot);

    var def = self.$$proto, $scope = self.$$scope, TMP_1, TMP_2, TMP_3, TMP_4, TMP_5, TMP_6, TMP_7, TMP_8, TMP_9, TMP_10, TMP_11, TMP_12, TMP_13, TMP_14, TMP_15, TMP_16, TMP_17, TMP_18, TMP_19, TMP_20, TMP_21, TMP_22, TMP_23, TMP_24, TMP_25, TMP_26, TMP_27, TMP_28, TMP_29, TMP_30, TMP_31, TMP_32, TMP_33, TMP_34, TMP_35, TMP_36, TMP_37, TMP_38, TMP_39, TMP_40, TMP_41, TMP_42, TMP_43, TMP_44, TMP_45, TMP_46, TMP_47, TMP_48, TMP_49, TMP_50, TMP_51, TMP_52, TMP_53, TMP_54, TMP_55, TMP_56, TMP_57, TMP_58, TMP_59, TMP_61, TMP_63, TMP_65, TMP_68, TMP_69, TMP_70, TMP_72;

    def.gameType = def.sortType = def.diceText = def.d66Type = nil;
    Opal.cdecl($scope, 'EMPTY_PREFIXES_PATTERN', (/(^|\s)(S)?()(\s|$)/i).$freeze());

    Opal.defs(self, '$prefixes', TMP_1 = function $$prefixes() {
      var self = this;
      if (self.prefixes == null) self.prefixes = nil;

      return self.prefixes;
    }, TMP_1.$$arity = 0);

    Opal.defs(self, '$prefixesPattern', TMP_2 = function $$prefixesPattern() {
      var self = this;
      if (self.prefixesPattern == null) self.prefixesPattern = nil;

      return self.prefixesPattern;
    }, TMP_2.$$arity = 0);

    Opal.defs(self, '$setPrefixes', TMP_3 = function $$setPrefixes(prefixes) {
      var $a, $b, self = this, pattern = nil;

      self.prefixes = ($a = ($b = prefixes).$map, $a.$$p = "freeze".$to_proc(), $a).call($b).$freeze();
      pattern = "(^|\\s)(S)?(" + (prefixes.$join("|")) + ")(\\s|$)";
      self.prefixesPattern = $scope.get('Regexp').$new(pattern, (($scope.get('Regexp')).$$scope.get('IGNORECASE'))).$freeze();
      return self;
    }, TMP_3.$$arity = 1);

    Opal.defs(self, '$clearPrefixes', TMP_4 = function $$clearPrefixes() {
      var self = this;

      self.prefixes = [].$freeze();
      self.prefixesPattern = $scope.get('EMPTY_PREFIXES_PATTERN');
      return self;
    }, TMP_4.$$arity = 0);

    Opal.defs(self, '$inherited', TMP_5 = function $$inherited(subclass) {
      var self = this;

      return subclass.$clearPrefixes();
    }, TMP_5.$$arity = 1);

    self.$clearPrefixes();

    (Opal.cvars['@@bcdice'] = nil);

    (Opal.cvars['@@DEFAULT_SEND_MODE'] = 2);

    Opal.defn(self, '$initialize', TMP_6 = function $$initialize() {
      var $a, $b, self = this;
      if ($gvars.stderr == null) $gvars.stderr = nil;

      self.sendMode = (($a = Opal.cvars['@@DEFAULT_SEND_MODE']) == null ? nil : $a);
      self.sortType = 0;
      self.sameDiceRerollCount = 0;
      self.sameDiceRerollType = 0;
      self.d66Type = 1;
      self.isPrintMaxDice = false;
      self.upplerRollThreshold = 0;
      self.unlimitedRollDiceType = 0;
      self.rerollNumber = 0;
      self.defaultSuccessTarget = "";
      self.rerollLimitCount = 10000;
      self.fractionType = "omit";
      self.gameType = "DiceBot";
      if ((($a = ($b = self.$prefixs()['$empty?']()['$!'](), $b !== false && $b !== nil && $b != null ?self.$class().$prefixes()['$empty?']() : $b)) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        $gvars.stderr.$puts("" + (self.$gameType()) + ": #prefixs is deprecated. Please use .setPrefixes.");
        return self.$class().$setPrefixes(self.$prefixs());
        } else {
        return nil
      };
    }, TMP_6.$$arity = 0);

    self.$attr_accessor("rerollLimitCount");

    self.$attr_reader("sendMode", "sameDiceRerollCount", "sameDiceRerollType", "d66Type");

    self.$attr_reader("isPrintMaxDice", "upplerRollThreshold", "unlimitedRollDiceType");

    self.$attr_reader("defaultSuccessTarget", "rerollNumber", "fractionType");

    Opal.defn(self, '$postSet', TMP_7 = function $$postSet() {
      var self = this;

      return nil;
    }, TMP_7.$$arity = 0);

    Opal.defn(self, '$info', TMP_8 = function $$info() {
      var self = this;

      return $hash2(["name", "gameType", "prefixs", "info"], {"name": self.$gameName(), "gameType": self.$gameType(), "prefixs": self.$class().$prefixes(), "info": self.$getHelpMessage()});
    }, TMP_8.$$arity = 0);

    Opal.defn(self, '$gameName', TMP_9 = function $$gameName() {
      var self = this;

      return self.$gameType();
    }, TMP_9.$$arity = 0);

    Opal.defn(self, '$prefixes', TMP_10 = function $$prefixes() {
      var self = this;

      return self.$class().$prefixes();
    }, TMP_10.$$arity = 0);

    Opal.alias(self, 'prefixs', 'prefixes');

    Opal.defn(self, '$gameType', TMP_11 = function $$gameType() {
      var self = this;

      return self.gameType;
    }, TMP_11.$$arity = 0);

    Opal.defn(self, '$setGameType', TMP_12 = function $$setGameType(type) {
      var self = this;

      return self.gameType = type;
    }, TMP_12.$$arity = 1);

    Opal.defn(self, '$setSendMode', TMP_13 = function $$setSendMode(m) {
      var self = this;

      return self.sendMode = m;
    }, TMP_13.$$arity = 1);

    Opal.defn(self, '$upplerRollThreshold=', TMP_14 = function(v) {
      var self = this;

      return self.upplerRollThreshold = v;
    }, TMP_14.$$arity = 1);

    Opal.defn(self, '$bcdice=', TMP_15 = function(b) {
      var self = this;

      return (Opal.cvars['@@bcdice'] = b);
    }, TMP_15.$$arity = 1);

    Opal.defn(self, '$bcdice', TMP_16 = function $$bcdice() {
      var $a, self = this;

      return (($a = Opal.cvars['@@bcdice']) == null ? nil : $a);
    }, TMP_16.$$arity = 0);

    Opal.defn(self, '$rand', TMP_17 = function $$rand(max) {
      var $a, self = this;

      return (($a = Opal.cvars['@@bcdice']) == null ? nil : $a).$rand(max);
    }, TMP_17.$$arity = 1);

    Opal.defn(self, '$check_suc', TMP_18 = function $$check_suc($a_rest) {
      var $b, $c, self = this, params;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      params = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        params[$arg_idx - 0] = arguments[$arg_idx];
      }
      return ($b = (($c = Opal.cvars['@@bcdice']) == null ? nil : $c)).$check_suc.apply($b, Opal.to_a(params));
    }, TMP_18.$$arity = -1);

    Opal.defn(self, '$roll', TMP_19 = function $$roll($a_rest) {
      var $b, $c, self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      return ($b = (($c = Opal.cvars['@@bcdice']) == null ? nil : $c)).$roll.apply($b, Opal.to_a(args));
    }, TMP_19.$$arity = -1);

    Opal.defn(self, '$marshalSignOfInequality', TMP_20 = function $$marshalSignOfInequality($a_rest) {
      var $b, $c, self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      return ($b = (($c = Opal.cvars['@@bcdice']) == null ? nil : $c)).$marshalSignOfInequality.apply($b, Opal.to_a(args));
    }, TMP_20.$$arity = -1);

    Opal.defn(self, '$unlimitedRollDiceType', TMP_21 = function $$unlimitedRollDiceType() {
      var $a, self = this;

      return (($a = Opal.cvars['@@bcdice']) == null ? nil : $a).$unlimitedRollDiceType();
    }, TMP_21.$$arity = 0);

    Opal.defn(self, '$sortType', TMP_22 = function $$sortType() {
      var self = this;

      return self.sortType;
    }, TMP_22.$$arity = 0);

    Opal.defn(self, '$setSortType', TMP_23 = function $$setSortType(s) {
      var self = this;

      return self.sortType = s;
    }, TMP_23.$$arity = 1);

    Opal.defn(self, '$d66', TMP_24 = function $$d66($a_rest) {
      var $b, $c, self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      return ($b = (($c = Opal.cvars['@@bcdice']) == null ? nil : $c)).$getD66Value.apply($b, Opal.to_a(args));
    }, TMP_24.$$arity = -1);

    Opal.defn(self, '$rollDiceAddingUp', TMP_25 = function $$rollDiceAddingUp($a_rest) {
      var $b, $c, self = this, arg;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      arg = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        arg[$arg_idx - 0] = arguments[$arg_idx];
      }
      return ($b = (($c = Opal.cvars['@@bcdice']) == null ? nil : $c)).$rollDiceAddingUp.apply($b, Opal.to_a(arg));
    }, TMP_25.$$arity = -1);

    Opal.defn(self, '$getHelpMessage', TMP_26 = function $$getHelpMessage() {
      var self = this;

      return "";
    }, TMP_26.$$arity = 0);

    Opal.defn(self, '$parren_killer', TMP_27 = function $$parren_killer(string) {
      var $a, self = this;

      return (($a = Opal.cvars['@@bcdice']) == null ? nil : $a).$parren_killer(string);
    }, TMP_27.$$arity = 1);

    Opal.defn(self, '$changeText', TMP_28 = function $$changeText(string) {
      var self = this;

      self.$debug("DiceBot.parren_killer_add called");
      return string;
    }, TMP_28.$$arity = 1);

    Opal.defn(self, '$dice_command', TMP_29 = function $$dice_command(string, nick_e) {
      var $a, $b, self = this, secret_flg = nil, secretMarker = nil, command = nil, output_msg = nil;

      if ((($a = (self.$isGetOriginalMessage())) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        string = (($a = Opal.cvars['@@bcdice']) == null ? nil : $a).$getOriginalMessage()};
      self.$debug("dice_command Begin string", string);
      secret_flg = false;
      if ((($a = self.$class().$prefixesPattern()['$=~'](string)) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        } else {
        self.$debug("not match in prefixes");
        return ["1", secret_flg];
      };
      secretMarker = (($a = $gvars['~']) === nil ? nil : $a['$[]'](2));
      command = (($a = $gvars['~']) === nil ? nil : $a['$[]'](3));
      command = self.$removeDiceCommandMessage(command);
      self.$debug("dicebot after command", command);
      self.$debug("match");
      $b = self.$rollDiceCommandCatched(command), $a = Opal.to_ary($b), output_msg = ($a[0] == null ? nil : $a[0]), secret_flg = ($a[1] == null ? nil : $a[1]), $b;
      if ((($a = (((($b = output_msg['$nil?']()) !== false && $b !== nil && $b != null) ? $b : output_msg['$empty?']()))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        output_msg = "1"};
      ((($a = secret_flg) !== false && $a !== nil && $a != null) ? $a : secret_flg = false);
      if ((($a = (output_msg['$!=']("1"))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        output_msg = "" + (nick_e) + ": " + (output_msg)};
      if ((($a = (secretMarker)) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        if ((($a = (output_msg['$!=']("1"))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
          secret_flg = true}};
      return [output_msg, secret_flg];
    }, TMP_29.$$arity = 2);

    Opal.defn(self, '$isGetOriginalMessage', TMP_30 = function $$isGetOriginalMessage() {
      var self = this;

      return false;
    }, TMP_30.$$arity = 0);

    Opal.defn(self, '$removeDiceCommandMessage', TMP_31 = function $$removeDiceCommandMessage(command) {
      var self = this;

      return command.$sub(/[\s　].+/, "");
    }, TMP_31.$$arity = 1);

    Opal.defn(self, '$rollDiceCommandCatched', TMP_32 = function $$rollDiceCommandCatched(command) {
      var $a, $b, self = this, result = nil, secret_flg = nil, e = nil;
      if ($gvars["@"] == null) $gvars["@"] = nil;

      result = nil;
      try {
        self.$debug("call rollDiceCommand command", command);
        $b = self.$rollDiceCommand(command), $a = Opal.to_ary($b), result = ($a[0] == null ? nil : $a[0]), secret_flg = ($a[1] == null ? nil : $a[1]), $b;
      } catch ($err) {
        if (Opal.rescue($err, [$scope.get('StandardError')])) {e = $err;
          try {
            self.$debug("executeCommand exception", e.$to_s(), $gvars["@"].$join("\n"))
          } finally { Opal.pop_exception() }
        } else { throw $err; }
      };
      self.$debug("rollDiceCommand result", result);
      return [result, secret_flg];
    }, TMP_32.$$arity = 1);

    Opal.defn(self, '$rollDiceCommand', TMP_33 = function $$rollDiceCommand(command) {
      var self = this;

      return nil;
    }, TMP_33.$$arity = 1);

    Opal.defn(self, '$setDiceText', TMP_34 = function $$setDiceText(diceText) {
      var self = this;

      self.$debug("setDiceText diceText", diceText);
      return self.diceText = diceText;
    }, TMP_34.$$arity = 1);

    Opal.defn(self, '$setDiffText', TMP_35 = function $$setDiffText(diffText) {
      var self = this;

      return self.diffText = diffText;
    }, TMP_35.$$arity = 1);

    Opal.defn(self, '$dice_command_xRn', TMP_36 = function $$dice_command_xRn(string, nick_e) {
      var self = this;

      return "";
    }, TMP_36.$$arity = 2);

    Opal.defn(self, '$check_2D6', TMP_37 = function $$check_2D6(total_n, dice_n, signOfInequality, diff, dice_cnt, dice_max, n1, n_max) {
      var self = this;

      return "";
    }, TMP_37.$$arity = 8);

    Opal.defn(self, '$check_nD6', TMP_38 = function $$check_nD6(total_n, dice_n, signOfInequality, diff, dice_cnt, dice_max, n1, n_max) {
      var self = this;

      return "";
    }, TMP_38.$$arity = 8);

    Opal.defn(self, '$check_nD10', TMP_39 = function $$check_nD10(total_n, dice_n, signOfInequality, diff, dice_cnt, dice_max, n1, n_max) {
      var self = this;

      return "";
    }, TMP_39.$$arity = 8);

    Opal.defn(self, '$check_1D100', TMP_40 = function $$check_1D100(total_n, dice_n, signOfInequality, diff, dice_cnt, dice_max, n1, n_max) {
      var self = this;

      return "";
    }, TMP_40.$$arity = 8);

    Opal.defn(self, '$check_1D20', TMP_41 = function $$check_1D20(total_n, dice_n, signOfInequality, diff, dice_cnt, dice_max, n1, n_max) {
      var self = this;

      return "";
    }, TMP_41.$$arity = 8);

    Opal.defn(self, '$get_table_by_2d6', TMP_42 = function $$get_table_by_2d6(table) {
      var self = this;

      return self.$get_table_by_nD6(table, 2);
    }, TMP_42.$$arity = 1);

    Opal.defn(self, '$get_table_by_1d6', TMP_43 = function $$get_table_by_1d6(table) {
      var self = this;

      return self.$get_table_by_nD6(table, 1);
    }, TMP_43.$$arity = 1);

    Opal.defn(self, '$get_table_by_nD6', TMP_44 = function $$get_table_by_nD6(table, count) {
      var self = this;

      return self.$get_table_by_nDx(table, count, 6);
    }, TMP_44.$$arity = 2);

    Opal.defn(self, '$get_table_by_nDx', TMP_45 = function $$get_table_by_nDx(table, count, diceType) {
      var $a, $b, self = this, num = nil, text = nil;

      $b = self.$roll(count, diceType), $a = Opal.to_ary($b), num = ($a[0] == null ? nil : $a[0]), $b;
      text = self.$getTableValue(table['$[]']($rb_minus(num, count)));
      if ((($a = (text['$nil?']())) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        return ["1", 0]};
      return [text, num];
    }, TMP_45.$$arity = 3);

    Opal.defn(self, '$get_table_by_1d3', TMP_46 = function $$get_table_by_1d3(table) {
      var $a, $b, self = this, count = nil, num = nil, index = nil, text = nil;

      self.$debug("get_table_by_1d3");
      count = 1;
      $b = self.$roll(count, 6), $a = Opal.to_ary($b), num = ($a[0] == null ? nil : $a[0]), $b;
      self.$debug("num", num);
      index = ($rb_divide(($rb_minus(num, 1)), 2));
      self.$debug("index", index);
      text = table['$[]'](index);
      if ((($a = (text['$nil?']())) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        return ["1", 0]};
      return [text, num];
    }, TMP_46.$$arity = 1);

    Opal.defn(self, '$getD66', TMP_47 = function $$getD66(isSwap) {
      var self = this, number = nil;

      return number = self.$bcdice().$getD66(isSwap);
    }, TMP_47.$$arity = 1);

    Opal.defn(self, '$get_table_by_d66_swap', TMP_48 = function $$get_table_by_d66_swap(table) {
      var self = this, isSwap = nil, number = nil;

      isSwap = true;
      number = self.$bcdice().$getD66(isSwap);
      return [self.$get_table_by_number(number, table), number];
    }, TMP_48.$$arity = 1);

    Opal.defn(self, '$get_table_by_d66', TMP_49 = function $$get_table_by_d66(table) {
      var $a, $b, self = this, dice1 = nil, dummy = nil, dice2 = nil, num = nil, text = nil, indexText = nil;

      $b = self.$roll(1, 6), $a = Opal.to_ary($b), dice1 = ($a[0] == null ? nil : $a[0]), dummy = ($a[1] == null ? nil : $a[1]), $b;
      $b = self.$roll(1, 6), $a = Opal.to_ary($b), dice2 = ($a[0] == null ? nil : $a[0]), dummy = ($a[1] == null ? nil : $a[1]), $b;
      num = $rb_plus($rb_times(($rb_minus(dice1, 1)), 6), ($rb_minus(dice2, 1)));
      text = table['$[]'](num);
      indexText = "" + (dice1) + (dice2);
      if ((($a = (text['$nil?']())) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        return ["1", indexText]};
      return [text, indexText];
    }, TMP_49.$$arity = 1);

    Opal.defn(self, '$getDiceRolledAdditionalText', TMP_50 = function $$getDiceRolledAdditionalText(n1, n_max, dice_max) {
      var self = this;

      return "";
    }, TMP_50.$$arity = 3);

    Opal.defn(self, '$getDiceRevision', TMP_51 = function $$getDiceRevision(n_max, dice_max, total_n) {
      var self = this;

      return ["", 0];
    }, TMP_51.$$arity = 3);

    Opal.defn(self, '$changeDiceValueByDiceText', TMP_52 = function $$changeDiceValueByDiceText(dice_now, dice_str, isCheckSuccess, dice_max) {
      var self = this;

      return dice_now;
    }, TMP_52.$$arity = 4);

    Opal.defn(self, '$setRatingTable', TMP_53 = function $$setRatingTable(nick_e, tnick, channel_to_list) {
      var self = this;

      return "1";
    }, TMP_53.$$arity = 3);

    Opal.defn(self, '$getJackUpValueOnAddRoll', TMP_54 = function $$getJackUpValueOnAddRoll(dice_n) {
      var self = this;

      return 0;
    }, TMP_54.$$arity = 1);

    Opal.defn(self, '$isD9', TMP_55 = function $$isD9() {
      var self = this;

      return false;
    }, TMP_55.$$arity = 0);

    Opal.defn(self, '$getGrichText', TMP_56 = function $$getGrichText(numberSpot1, dice_cnt_total, suc) {
      var self = this;

      return "";
    }, TMP_56.$$arity = 3);

    Opal.defn(self, '$check2dCritical', TMP_57 = function $$check2dCritical(critical, dice_new, dice_arry, loop_count) {
      var self = this;

      return nil;
    }, TMP_57.$$arity = 4);

    Opal.defn(self, '$is2dCritical', TMP_58 = function $$is2dCritical() {
      var self = this;

      return false;
    }, TMP_58.$$arity = 0);

    Opal.defn(self, '$getDiceList', TMP_59 = function $$getDiceList() {
      var self = this;

      return self.$getDiceListFromDiceText(self.diceText);
    }, TMP_59.$$arity = 0);

    Opal.defn(self, '$getDiceListFromDiceText', TMP_61 = function $$getDiceListFromDiceText(diceText) {
      var $a, $b, TMP_60, self = this, diceList = nil, diceString = nil;

      self.$debug("getDiceList diceText", diceText);
      diceList = [];
      if ((($a = (/\[([\d,]+)\]/['$=~'](diceText))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        diceText = (($a = $gvars['~']) === nil ? nil : $a['$[]'](1))};
      if ((($a = (/([\d,]+)/['$=~'](diceText))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        } else {
        return diceList
      };
      diceString = (($a = $gvars['~']) === nil ? nil : $a['$[]'](1));
      diceList = ($a = ($b = diceString.$split(/,/)).$collect, $a.$$p = (TMP_60 = function(i){var self = TMP_60.$$s || this;
if (i == null) i = nil;
      return i.$to_i()}, TMP_60.$$s = self, TMP_60.$$arity = 1, TMP_60), $a).call($b);
      self.$debug("diceList", diceList);
      return diceList;
    }, TMP_61.$$arity = 1);

    Opal.defn(self, '$get_table_by_number', TMP_63 = function $$get_table_by_number(index, table, default$) {try {

      var $a, $b, TMP_62, self = this;

      if (default$ == null) {
        default$ = "1";
      }
      ($a = ($b = table).$each, $a.$$p = (TMP_62 = function(item){var self = TMP_62.$$s || this, $c, number = nil;
if (item == null) item = nil;
      number = item['$[]'](0);
        if ((($c = ($rb_ge(number, index))) !== nil && $c != null && (!$c.$$is_boolean || $c == true))) {
          Opal.ret(self.$getTableValue(item['$[]'](1)))
          } else {
          return nil
        };}, TMP_62.$$s = self, TMP_62.$$arity = 1, TMP_62), $a).call($b);
      return self.$getTableValue(default$);
      } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
    }, TMP_63.$$arity = -3);

    Opal.defn(self, '$getTableValue', TMP_65 = function $$getTableValue(data) {try {

      var $a, $b, TMP_64, self = this, lambdaBlock = nil;

      if ((($a = (data['$kind_of?']($scope.get('Proc')))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        lambdaBlock = ($a = ($b = self).$lambda, $a.$$p = (TMP_64 = function(){var self = TMP_64.$$s || this;

        Opal.ret(data.$call())}, TMP_64.$$s = self, TMP_64.$$arity = 0, TMP_64), $a).call($b);
        return lambdaBlock.$call();};
      return data;
      } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
    }, TMP_65.$$arity = 1);

    Opal.defn(self, '$analyzeDiceCommandResultMethod', TMP_68 = function $$analyzeDiceCommandResultMethod(command) {try {

      var $a, $b, TMP_66, $c, TMP_67, self = this, methodList = nil;

      methodList = ($a = ($b = self.$public_methods()).$select, $a.$$p = (TMP_66 = function(method){var self = TMP_66.$$s || this;
if (method == null) method = nil;
      return /^get.+DiceCommandResult$/['$==='](method.$to_s())}, TMP_66.$$s = self, TMP_66.$$arity = 1, TMP_66), $a).call($b);
      ($a = ($c = methodList).$each, $a.$$p = (TMP_67 = function(method){var self = TMP_67.$$s || this, $d, result = nil;
if (method == null) method = nil;
      result = self.$send(method, command);
        if ((($d = result['$nil?']()) !== nil && $d != null && (!$d.$$is_boolean || $d == true))) {
          return nil
          } else {
          Opal.ret(result)
        };}, TMP_67.$$s = self, TMP_67.$$arity = 1, TMP_67), $a).call($c);
      return nil;
      } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
    }, TMP_68.$$arity = 1);

    Opal.defn(self, '$get_table_by_nDx_extratable', TMP_69 = function $$get_table_by_nDx_extratable(table, count, diceType) {
      var $a, $b, self = this, number = nil, diceText = nil, text = nil;

      $b = self.$roll(count, diceType), $a = Opal.to_ary($b), number = ($a[0] == null ? nil : $a[0]), diceText = ($a[1] == null ? nil : $a[1]), $b;
      text = self.$getTableValue(table['$[]']($rb_minus(number, count)));
      return [text, number, diceText];
    }, TMP_69.$$arity = 3);

    Opal.defn(self, '$getTableCommandResult', TMP_70 = function $$getTableCommandResult(command, tables, isPrintDiceText) {
      var $a, $b, $c, $d, self = this, info = nil, name = nil, type = nil, table = nil, $case = nil, count = nil, limit = nil, item = nil, value = nil, output = nil, diceText = nil, text = nil, number = nil;

      if (isPrintDiceText == null) {
        isPrintDiceText = true;
      }
      info = tables['$[]'](command);
      if ((($a = info['$nil?']()) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        return nil};
      name = info['$[]']("name");
      type = info['$[]']("type").$upcase();
      table = info['$[]']("table");
      if ((($a = (($b = type['$==']("D66")) ? self.d66Type['$=='](2) : type['$==']("D66"))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        type = "D66S"};
      $b = (function() {$case = type;if (/(\d+)D6/['$===']($case)) {count = (($c = $gvars['~']) === nil ? nil : $c['$[]'](1)).$to_i();
      limit = $rb_minus($rb_times(6, count), ($rb_minus(count, 1)));
      table = self.$getTableInfoFromExtraTableText(table, limit);
      return self.$get_table_by_nDx_extratable(table, count, 6);}else if ("D66"['$===']($case) || "D66N"['$===']($case)) {table = self.$getTableInfoFromExtraTableText(table, 36);
      $d = self.$get_table_by_d66(table), $c = Opal.to_ary($d), item = ($c[0] == null ? nil : $c[0]), value = ($c[1] == null ? nil : $c[1]), $d;
      value = value.$to_i();
      output = item['$[]'](1);
      diceText = $rb_plus($rb_plus(($rb_divide(value, 10)).$to_s(), ","), (value['$%'](10)).$to_s());
      return [output, value, diceText];}else if ("D66S"['$===']($case)) {table = self.$getTableInfoFromExtraTableText(table, 21);
      $d = self.$get_table_by_d66_swap(table), $c = Opal.to_ary($d), output = ($c[0] == null ? nil : $c[0]), value = ($c[1] == null ? nil : $c[1]), $d;
      value = value.$to_i();
      diceText = $rb_plus($rb_plus(($rb_divide(value, 10)).$to_s(), ","), (value['$%'](10)).$to_s());
      return [output, value, diceText];}else {return self.$raise("invalid dice Type " + (command))}})(), $a = Opal.to_ary($b), text = ($a[0] == null ? nil : $a[0]), number = ($a[1] == null ? nil : $a[1]), diceText = ($a[2] == null ? nil : $a[2]), $b;
      text['$gsub!']("\\n", "\n");
      text = (($a = Opal.cvars['@@bcdice']) == null ? nil : $a).$rollTableMessageDiceText(text);
      if ((($a = (text['$nil?']())) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        return nil};
      if ((($a = (($b = isPrintDiceText !== false && isPrintDiceText !== nil && isPrintDiceText != null) ? (diceText['$nil?']()['$!']()) : isPrintDiceText)) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        return "" + (name) + "(" + (number) + "[" + (diceText) + "]) ＞ " + (text)};
      return "" + (name) + "(" + (number) + ") ＞ " + (text);
    }, TMP_70.$$arity = -3);

    return (Opal.defn(self, '$getTableInfoFromExtraTableText', TMP_72 = function $$getTableInfoFromExtraTableText(text, count) {
      var $a, $b, TMP_71, self = this, newTable = nil;

      if (count == null) {
        count = nil;
      }
      if ((($a = text['$kind_of?']($scope.get('String'))) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        text = text.$split(/\n/)};
      newTable = ($a = ($b = text).$map, $a.$$p = (TMP_71 = function(item){var self = TMP_71.$$s || this, $c, $d;
if (item == null) item = nil;
      if ((($c = ($d = item['$kind_of?']($scope.get('String')), $d !== false && $d !== nil && $d != null ?/^(\d+):(.*)/['$==='](item) : $d)) !== nil && $c != null && (!$c.$$is_boolean || $c == true))) {
          return [(($c = $gvars['~']) === nil ? nil : $c['$[]'](1)).$to_i(), (($c = $gvars['~']) === nil ? nil : $c['$[]'](2))]
          } else {
          return item
        }}, TMP_71.$$s = self, TMP_71.$$arity = 1, TMP_71), $a).call($b);
      if ((($a = count['$nil?']()) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
      } else if ((($a = newTable.$size()['$!='](count)) !== nil && $a != null && (!$a.$$is_boolean || $a == true))) {
        self.$raise("invalid table size:" + (newTable.$size()) + "\n" + (newTable.$inspect()))};
      return newTable;
    }, TMP_72.$$arity = -2), nil) && 'getTableInfoFromExtraTableText';
  })($scope.base, null)
})(Opal);

/* Generated by Opal 0.10.5 */
(function(Opal) {
  var self = Opal.top, $scope = Opal, nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$exit']);
  return $scope.get('Kernel').$exit()
})(Opal);
